<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="author" content="Matt McKellar-Spence">
    <meta name="description" content="Example code with different libraries">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Save object in browser</title>
    <link href="http://css.mattms.info/basic/light/index.css?t=2014-12-21T1300+10" rel="stylesheet" title="Basic light" type="text/css">
    <link href="http://css.mattms.info/basic/dark/index.css?t=2014-12-21T1300+10" rel="alternate stylesheet" title="Basic dark" type="text/css">
    <link href="http://css.mattms.info/solarized/dark/index.css?t=2014-12-21T1300+10" rel="alternate stylesheet" title="Solarized dark" type="text/css">
        <script src="/components/jquery/2/1/3/min.js" type="text/javascript"></script>
        <script src="/components/pouchdb/3/2/1/min.js" type="text/javascript"></script>
    <script type="text/javascript">$(function() {
  var db, my_doc_id;
  db = new PouchDB('my_db');
  my_doc_id = 'my_text';
  db.get(my_doc_id, function(err, doc) {
    var value;
    if (err) {
      return console.error(err);
    } else {
      return value = $('#my_input').val(doc.my_value);
    }
  });
  return $('#my_button').click(function(e) {
    var doc, value;
    e.preventDefault();
    value = $('#my_input').val();
    doc = {
      _id: my_doc_id,
      my_value: value
    };
    return db.put(doc)["catch"](function(err) {
      return console.error(err);
    }).then(function(doc) {
      return console.log('JSON doc saved!');
    });
  });
});

    </script>
  </head>
  <body>
    <article class="container"><h1 id="save-object-in-browser-with-pouchdb">Save object in browser with PouchDB</h1>
<pre><code>$ -&gt;
    db = new PouchDB &#39;my_db&#39;

    my_doc_id = &#39;my_text&#39;


    db.get my_doc_id
    , (err, doc)-&gt;
        if err
            console.error err

        else
            value = $ &#39;#my_input&#39;
            .val doc.my_value


    $ &#39;#my_button&#39;
    .click (e)-&gt;
        e.preventDefault()

        value = $ &#39;#my_input&#39;
        .val()

        doc =
            _id: my_doc_id
            my_value: value

        db.put doc

        .catch (err)-&gt;
            console.error err

        .then (doc)-&gt;
            console.log &#39;JSON doc saved!&#39;
</code></pre>
      <textarea id="my_input"></textarea>
      <button id="my_button">Save</button>
    </article>
    <footer class="container">
      <hr>
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="http://about.mattms.info">Read about me</a></li>
        <li><a href="https://github.com/MattMS/web_tricks">View on GitHub</a></li>
      </ul>
    </footer>
  </body>
</html>